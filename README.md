# ğŸŒ¸ Sakura-é¢‘é“æ€»ç»“åŠ©æ‰‹ v1.2.1

[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
[![Python Version](https://img.shields.io/badge/python-3.13+-blue.svg)](https://www.python.org/downloads/)
[![Telethon](https://img.shields.io/badge/Telethon-1.34+-blue.svg)](https://docs.telethon.dev/)
[![Docker](https://img.shields.io/badge/Docker-20.10%2B-blue.svg)](https://www.docker.com/)
[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)](https://github.com/Sakura520222/Sakura-Channel-Summary-Assistant/pulls)

> ä¸€ä¸ªåŸºäºTelegram APIå’ŒAIæŠ€æœ¯çš„æ™ºèƒ½é¢‘é“å†…å®¹ç®¡ç†å·¥å…·ï¼Œä¸“ä¸ºTelegramé¢‘é“ç®¡ç†å‘˜è®¾è®¡ï¼Œæä¾›è‡ªåŠ¨åŒ–çš„æ¶ˆæ¯æ±‡æ€»ã€æŠ¥å‘Šç”Ÿæˆå’ŒæŠ•ç¥¨äº’åŠ¨æœåŠ¡ã€‚

## ğŸ“– ç›®å½•

- [âœ¨ åŠŸèƒ½ç‰¹æ€§](#-åŠŸèƒ½ç‰¹æ€§)
- [ğŸš€ å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
  - [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
  - [å®‰è£…éƒ¨ç½²](#å®‰è£…éƒ¨ç½²)
- [ğŸ³ Dockeréƒ¨ç½²](#-dockeréƒ¨ç½²)
- [ğŸŒ Webç®¡ç†ç•Œé¢](#-webç®¡ç†ç•Œé¢)
- [ğŸ“‹ ä½¿ç”¨è¯´æ˜](#-ä½¿ç”¨è¯´æ˜)
  - [å‘½ä»¤åˆ—è¡¨](#å‘½ä»¤åˆ—è¡¨)
  - [AIé…ç½®ç®¡ç†](#aié…ç½®ç®¡ç†)
  - [é¢‘é“ç®¡ç†](#é¢‘é“ç®¡ç†)
- [ğŸ—ï¸ é¡¹ç›®ç»“æ„](#ï¸-é¡¹ç›®ç»“æ„)
- [ğŸ”§ æŠ€æœ¯æ ˆ](#-æŠ€æœ¯æ ˆ)
- [ğŸ“ æ›´æ–°æ—¥å¿—](#-æ›´æ–°æ—¥å¿—)
- [ğŸ“„ è®¸å¯è¯](#-è®¸å¯è¯)
- [ğŸ¤ è´¡çŒ®](#-è´¡çŒ®)

## âœ¨ åŠŸèƒ½ç‰¹æ€§

| åŠŸèƒ½ | æè¿° | çŠ¶æ€ |
|------|------|------|
| ğŸ¤– **AIæ™ºèƒ½æ€»ç»“** | åˆ©ç”¨AIå¤§æ¨¡å‹å¯¹æ¶ˆæ¯è¿›è¡Œæ·±åº¦åˆ†æï¼Œæå–æ ¸å¿ƒè¦ç‚¹ | âœ… |
| ğŸ” **è‡ªåŠ¨æ¶ˆæ¯æŠ“å–** | å®šæœŸç›‘æ§æŒ‡å®šTelegramé¢‘é“ï¼Œè‡ªåŠ¨æŠ“å–å¹¶æ•´ç†æ¶ˆæ¯å†…å®¹ | âœ… |
| â° **å®šæ—¶å‘¨æŠ¥æ¨é€** | æ¯å‘¨ä¸€æ—©ä¸Š9ç‚¹è‡ªåŠ¨ç”Ÿæˆå¹¶å‘é€é¢‘é“å‘¨æŠ¥ | âœ… |
| âš¡ **æ‰‹åŠ¨è§¦å‘æ€»ç»“** | æ”¯æŒç®¡ç†å‘˜é€šè¿‡å‘½ä»¤éšæ—¶ç”Ÿæˆæ€»ç»“ | âœ… |
| ğŸ”§ **è‡ªå®šä¹‰AIé…ç½®** | æ”¯æŒå¤šç§OpenAIå…¼å®¹APIæœåŠ¡ï¼ˆDeepSeekã€OpenAIç­‰ï¼‰ | âœ… |
| ğŸ¯ **è‡ªå®šä¹‰æç¤ºè¯** | å…è®¸ç®¡ç†å‘˜è®¾ç½®ä¸“å±æç¤ºè¯ï¼Œçµæ´»è°ƒæ•´æ€»ç»“é£æ ¼ | âœ… |
| ğŸ‘¥ **å¤šç®¡ç†å‘˜æ”¯æŒ** | å¯é…ç½®å¤šä¸ªç®¡ç†å‘˜IDï¼ŒæŠ¥å‘ŠåŒæ—¶å‘é€ç»™æ‰€æœ‰ç®¡ç†å‘˜ | âœ… |
| ğŸ“ **é•¿æ¶ˆæ¯åˆ†æ®µå‘é€** | æ™ºèƒ½å¤„ç†è¶…é•¿æ€»ç»“å†…å®¹ï¼Œè‡ªåŠ¨åˆ†æ®µå‘é€ | âœ… |
| ğŸŒ **å¤šé¢‘é“æ”¯æŒ** | åŒæ—¶ç›‘æ§å’Œæ€»ç»“å¤šä¸ªé¢‘é“çš„å†…å®¹ | âœ… |
| â±ï¸ **æ™ºèƒ½æ—¶é—´è®°å½•** | è‡ªåŠ¨è®°å½•æ€»ç»“æ—¶é—´ï¼Œä»…è·å–æ–°æ¶ˆæ¯æé«˜æ•ˆç‡ | âœ… |
| â° **é¢‘é“çº§æ—¶é—´é…ç½®** | ä¸ºæ¯ä¸ªé¢‘é“å•ç‹¬é…ç½®è‡ªåŠ¨æ€»ç»“æ—¶é—´ | âœ… |
| ğŸ›¡ï¸ **é”™è¯¯å¤„ç†ä¸æ¢å¤** | æ™ºèƒ½é‡è¯•æœºåˆ¶ã€å¥åº·æ£€æŸ¥å’Œä¼˜é›…å…³é—­ | âœ… |
| ğŸŒ **å®Œæ•´Webç®¡ç†ç•Œé¢** | ç›´è§‚çš„æµè§ˆå™¨ç•Œé¢ç®¡ç†æ‰€æœ‰åŠŸèƒ½ | âœ… |
| ğŸ“Š **æŠ•ç¥¨æ¶ˆæ¯åŠŸèƒ½** | æ€»ç»“æ¶ˆæ¯å‘é€åè‡ªåŠ¨ç”ŸæˆæŠ•ç¥¨å¹¶å‘é€åˆ°è®¨è®ºç»„è¯„è®ºåŒº | âœ… |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Python 3.13+** æˆ– **Docker 20.10+**
- **Telegram Bot Token**ï¼ˆä» [@BotFather](https://t.me/BotFather) è·å–ï¼‰
- **Telegram API ID å’Œ API Hash**ï¼ˆä» [my.telegram.org](https://my.telegram.org) è·å–ï¼‰
- **OpenAIå…¼å®¹API Key**ï¼ˆå¦‚ [DeepSeek](https://platform.deepseek.com/)ã€[OpenAI](https://platform.openai.com/) ç­‰ï¼‰

### å®‰è£…éƒ¨ç½²

#### æ–¹æ³•ä¸€ï¼šæœ¬åœ°è¿è¡Œï¼ˆæ¨èå¼€å‘è€…ï¼‰

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/Sakura520222/Sakura-Channel-Summary-Assistant.git
cd Sakura-Channel-Summary-Assistant

# 2. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 3. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å†™æ‚¨çš„é…ç½®

# 4. è¿è¡Œé¡¹ç›®
python main.py
```

#### æ–¹æ³•äºŒï¼šDockerä¸€é”®éƒ¨ç½²ï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/Sakura520222/Sakura-Channel-Summary-Assistant.git
cd Sakura-Channel-Summary-Assistant

# 2. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å†™æ‚¨çš„é…ç½®

# 3. å¯åŠ¨æœåŠ¡
docker-compose up -d

# 4. æŸ¥çœ‹æ—¥å¿—ï¼ˆé¦–æ¬¡è¿è¡Œéœ€è¦Telegramç™»å½•ï¼‰
docker-compose logs -f
```

#### é…ç½®æ–‡ä»¶ç¤ºä¾‹ (`.env`)

```env
# ===== Telegramé…ç½® =====
TELEGRAM_API_ID=your_api_id
TELEGRAM_API_HASH=your_api_hash
TELEGRAM_BOT_TOKEN=your_bot_token

# ===== AIé…ç½®ï¼ˆæ”¯æŒä»»æ„OpenAIå…¼å®¹APIï¼‰ =====
# æ–¹å¼1ï¼šä½¿ç”¨DeepSeek
LLM_API_KEY=your_deepseek_api_key
LLM_BASE_URL=https://api.deepseek.com
LLM_MODEL=deepseek-chat

# æ–¹å¼2ï¼šä½¿ç”¨OpenAI
# LLM_API_KEY=your_openai_api_key
# LLM_BASE_URL=https://api.openai.com/v1
# LLM_MODEL=gpt-3.5-turbo

# ===== é¢‘é“é…ç½® =====
TARGET_CHANNEL=https://t.me/your_channel

# ===== ç®¡ç†å‘˜é…ç½®ï¼ˆæ”¯æŒå¤šä¸ªIDï¼Œç”¨é€—å·åˆ†éš”ï¼‰ =====
REPORT_ADMIN_IDS=admin_id1,admin_id2

# ===== æ—¥å¿—çº§åˆ«é…ç½® =====
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL

# ===== Webç®¡ç†ç•Œé¢é…ç½® =====
WEB_PORT=8000  # Webç®¡ç†ç•Œé¢ç«¯å£ï¼Œå¯è‡ªå®šä¹‰ï¼ˆå¦‚9000ã€8080ç­‰ï¼‰
WEB_ADMIN_PASSWORD=your_admin_password_here  # Webç®¡ç†ç•Œé¢ç™»å½•å¯†ç 

# ===== æŠ•ç¥¨åŠŸèƒ½é…ç½® =====
ENABLE_POLL=True  # æ˜¯å¦å¯ç”¨æŠ•ç¥¨åŠŸèƒ½ï¼Œé»˜è®¤å¼€å¯
```

## ğŸ³ Dockeréƒ¨ç½²

### ä¸€é”®éƒ¨ç½²

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker-compose logs -f

# åœæ­¢æœåŠ¡
docker-compose down
```

### æ•°æ®æŒä¹…åŒ–

å®¹å™¨ä½¿ç”¨æœ¬åœ°å·è¿›è¡Œæ•°æ®æŒä¹…åŒ–ï¼Œæ‰€æœ‰é‡è¦æ•°æ®éƒ½ä¿å­˜åœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­ï¼š

```
Sakura-Channel-Summary-Assistant/
â”œâ”€â”€ ğŸ“„ é…ç½®æ–‡ä»¶ï¼ˆæŒä¹…åŒ–ä¿å­˜ï¼‰
â”‚   â”œâ”€â”€ .env                    # ç¯å¢ƒå˜é‡é…ç½®
â”‚   â”œâ”€â”€ config.json             # AIé…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ prompt.txt              # æç¤ºè¯æ–‡ä»¶
â”‚   â””â”€â”€ .last_summary_time.json # æ€»ç»“æ—¶é—´è®°å½•æ–‡ä»¶
â”‚
â”œâ”€â”€ ğŸ“„ ä¼šè¯æ–‡ä»¶ï¼ˆæŒä¹…åŒ–ä¿å­˜ï¼‰
â”‚   â”œâ”€â”€ bot_session.session     # Telegramä¸»ä¼šè¯
â”‚   â”œâ”€â”€ bot_session_web.session # Webç•Œé¢ä¼šè¯
â”‚   â”œâ”€â”€ health_check.session    # å¥åº·æ£€æŸ¥ä¼šè¯
â”‚   â””â”€â”€ *.session-journal       # ä¼šè¯æ—¥å¿—æ–‡ä»¶
â”‚
â””â”€â”€ ğŸ“„ Dockeré…ç½®
    â”œâ”€â”€ docker-compose.yml      # Docker Composeé…ç½®
    â””â”€â”€ Dockerfile              # Dockeré•œåƒæ„å»º
```

**é‡è¦è¯´æ˜ï¼š**
- æ‰€æœ‰é…ç½®æ–‡ä»¶ï¼ˆ`.env`ã€`config.json`ã€`prompt.txt`ï¼‰éƒ½ä¿å­˜åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼Œç¡®ä¿å®¹å™¨é‡å¯åé…ç½®ä¸ä¸¢å¤±
- Telegramä¼šè¯æ–‡ä»¶ï¼ˆ`*.session`ï¼‰æŒä¹…åŒ–ä¿å­˜ï¼Œé¿å…é‡å¤ç™»å½•
- æ•°æ®ç›®å½•ç»“æ„å·²ç®€åŒ–ï¼Œä¸å†ä½¿ç”¨å•ç‹¬çš„`data/`ç›®å½•ï¼Œæ‰€æœ‰æ–‡ä»¶ç›´æ¥ä¿å­˜åœ¨é¡¹ç›®æ ¹ç›®å½•

### ç®¡ç†å‘½ä»¤

```bash
# è¿›å…¥å®¹å™¨
docker-compose exec sakura-summary-bot bash

# é‡å¯æœåŠ¡
docker-compose restart

# æ›´æ–°æœåŠ¡ï¼ˆé‡æ–°æ„å»ºé•œåƒï¼‰
docker-compose up -d --build

# æŸ¥çœ‹å¥åº·çŠ¶æ€
docker inspect --format='{{json .State.Health}}' sakura-summary-bot
```

## ğŸŒ Webç®¡ç†ç•Œé¢

Sakura-é¢‘é“æ€»ç»“åŠ©æ‰‹æä¾›äº†å®Œæ•´çš„Webç®¡ç†ç•Œé¢ï¼Œå¯ä»¥é€šè¿‡æµè§ˆå™¨ç›´è§‚åœ°ç®¡ç†æœºå™¨äººé…ç½®å’ŒåŠŸèƒ½ã€‚

### è®¿é—®æ–¹å¼

1. **å¯åŠ¨æœåŠ¡**ï¼š`python main.py` æˆ– `docker-compose up -d`
2. **è®¿é—®åœ°å€**ï¼š
   - **é»˜è®¤ç«¯å£**ï¼šhttp://localhost:8000
   - **è‡ªå®šä¹‰ç«¯å£**ï¼šåœ¨`.env`æ–‡ä»¶ä¸­è®¾ç½®`WEB_PORT=9000`ï¼Œç„¶åè®¿é—® http://localhost:9000
   - **å±€åŸŸç½‘è®¿é—®**ï¼šå¯åŠ¨æ—¶ä¼šæ˜¾ç¤ºå±€åŸŸç½‘IPåœ°å€ï¼Œå¦‚ http://192.168.1.100:8000
3. **ç™»å½•å¯†ç **ï¼šé€šè¿‡`.env`æ–‡ä»¶ä¸­çš„`WEB_ADMIN_PASSWORD`é…ç½®ï¼ˆé»˜è®¤ï¼š`Sakura`ï¼‰

### å¤šåœ°å€è®¿é—®
Webç®¡ç†ç•Œé¢å¯åŠ¨æ—¶ä¼šæ˜¾ç¤ºæ‰€æœ‰å¯è®¿é—®åœ°å€ï¼š
- æœ¬åœ°è®¿é—®: http://127.0.0.1:{PORT} æˆ– http://localhost:{PORT}
- æ‰€æœ‰æ¥å£: http://0.0.0.0:{PORT}
- å±€åŸŸç½‘è®¿é—®: http://{LAN_IP}:{PORT}ï¼ˆè‡ªåŠ¨è·å–æœ¬åœ°IPåœ°å€ï¼‰

### åŠŸèƒ½é¡µé¢

| é¡µé¢ | åŠŸèƒ½ | è®¿é—®è·¯å¾„ |
|------|------|----------|
| ğŸ“Š **ä»ªè¡¨æ¿** | ç³»ç»Ÿæ¦‚è§ˆã€å¥åº·çŠ¶æ€ã€é”™è¯¯ç»Ÿè®¡ | `/` |
| ğŸ“º **é¢‘é“ç®¡ç†** | æ·»åŠ /åˆ é™¤é¢‘é“ï¼Œè®¾ç½®è‡ªåŠ¨æ€»ç»“æ—¶é—´ | `/channels` |
| âš™ï¸ **é…ç½®ç®¡ç†** | æŸ¥çœ‹å’Œä¿®æ”¹AIé…ç½® | `/config` |
| â° **ä»»åŠ¡ç®¡ç†** | æ‰‹åŠ¨è§¦å‘æ€»ç»“ï¼ŒæŸ¥çœ‹å®šæ—¶ä»»åŠ¡ | `/tasks` |
| ğŸ“ **æ—¥å¿—æŸ¥çœ‹** | æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ï¼Œæ”¯æŒæœç´¢å’Œæ¸…ç©º | `/logs` |
| ğŸ–¥ï¸ **ç³»ç»Ÿä¿¡æ¯** | APIå‡­è¯ã€ç®¡ç†å‘˜åˆ—è¡¨ã€é”™è¯¯ç»Ÿè®¡ | `/system` |

### æŠ€æœ¯ç‰¹æ€§

- âœ… **å“åº”å¼è®¾è®¡**ï¼šé€‚é…æ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡
- âœ… **å®æ—¶åŒæ­¥**ï¼šæ‰€æœ‰é…ç½®æ›´æ”¹å®æ—¶ä¿å­˜åˆ°`config.json`
- âœ… **ä¼šè¯ç®¡ç†**ï¼šå®‰å…¨çš„ç™»å½•è®¤è¯ç³»ç»Ÿ
- âœ… **APIç«¯ç‚¹**ï¼šæ”¯æŒé¢‘é“ç®¡ç†ã€é…ç½®æ›´æ–°ã€ä»»åŠ¡è§¦å‘ç­‰æ“ä½œ
- âœ… **é”™è¯¯å¤„ç†**ï¼šé›†æˆç°æœ‰çš„é”™è¯¯å¤„ç†ç³»ç»Ÿ
- âœ… **ä¸Telegramå‘½ä»¤å…¼å®¹**ï¼šé€šè¿‡ç›¸åŒçš„é…ç½®æ–‡ä»¶åŒæ­¥

## ğŸ“‹ ä½¿ç”¨è¯´æ˜

### å‘½ä»¤åˆ—è¡¨

| å‘½ä»¤ | åˆ«å | åŠŸèƒ½ | ç¤ºä¾‹ |
|------|------|------|------|
| `/summary` | `/ç«‹å³æ€»ç»“` | ç«‹å³ç”Ÿæˆæœ¬å‘¨é¢‘é“æ¶ˆæ¯æ±‡æ€» | `/summary` |
| `/setprompt` | `/è®¾ç½®æç¤ºè¯` | è®¾ç½®è‡ªå®šä¹‰æç¤ºè¯ | `/setprompt` |
| `/showaicfg` | `/æŸ¥çœ‹AIé…ç½®` | æŸ¥çœ‹å½“å‰AIé…ç½®ä¿¡æ¯ | `/showaicfg` |
| `/setaicfg` | `/è®¾ç½®AIé…ç½®` | è®¾ç½®è‡ªå®šä¹‰AIé…ç½® | `/setaicfg` |
| `/showchannels` | `/æŸ¥çœ‹é¢‘é“åˆ—è¡¨` | æŸ¥çœ‹æ‰€æœ‰é…ç½®çš„é¢‘é“ | `/showchannels` |
| `/addchannel` | `/æ·»åŠ é¢‘é“` | æ·»åŠ æ–°çš„é¢‘é“åˆ°ç›‘æ§åˆ—è¡¨ | `/addchannel https://t.me/example` |
| `/deletechannel` | `/åˆ é™¤é¢‘é“` | ä»ç›‘æ§åˆ—è¡¨ä¸­åˆ é™¤é¢‘é“ | `/deletechannel https://t.me/example` |
| `/restart` | `/é‡å¯` | é‡å¯æœºå™¨äºº | `/restart` |
| `/changelog` | `/æ›´æ–°æ—¥å¿—` | æŸ¥çœ‹æ›´æ–°æ—¥å¿— | `/changelog` |

### AIé…ç½®ç®¡ç†

#### è®¾ç½®AIé…ç½®æµç¨‹

```bash
# 1. å‘é€è®¾ç½®å‘½ä»¤
/setaicfg

# 2. æŒ‰æç¤ºä¾æ¬¡è®¾ç½®ï¼ˆå‘é€/skipè·³è¿‡ï¼Œ/cancelå–æ¶ˆï¼‰
#    - API Key
#    - Base URL  
#    - Model

# 3. é…ç½®å®Œæˆï¼Œç«‹å³ç”Ÿæ•ˆ
```

#### æ”¯æŒçš„AIæœåŠ¡

| æœåŠ¡ | Base URL | æ¨¡å‹ç¤ºä¾‹ | å¤‡æ³¨ |
|------|----------|----------|------|
| **DeepSeek** | `https://api.deepseek.com` | `deepseek-chat` | æ¨èï¼Œæ€§ä»·æ¯”é«˜ |
| **OpenAI** | `https://api.openai.com/v1` | `gpt-3.5-turbo` | å…¼å®¹æ€§å¥½ |
| **å…¶ä»–å…¼å®¹API** | æ‚¨çš„APIåœ°å€ | æ‚¨çš„æ¨¡å‹åç§° | ä»»æ„OpenAIå…¼å®¹API |

### é¢‘é“ç®¡ç†

#### æ·»åŠ é¢‘é“

```bash
# æ·»åŠ å•ä¸ªé¢‘é“
/addchannel https://t.me/examplechannel

# æ·»åŠ å¤šä¸ªé¢‘é“ï¼ˆåˆ†åˆ«æ‰§è¡Œï¼‰
/addchannel https://t.me/channel1
/addchannel https://t.me/channel2
```

#### é¢‘é“æ—¶é—´é…ç½®

```bash
# æŸ¥çœ‹æ‰€æœ‰é¢‘é“é…ç½®
/showchannelschedule

# è®¾ç½®é¢‘é“è‡ªåŠ¨æ€»ç»“æ—¶é—´
/setchannelschedule FireflyLeak tue 10 30
# å«ä¹‰ï¼šFireflyLeaké¢‘é“æ¯å‘¨äºŒ10:30æ‰§è¡Œè‡ªåŠ¨æ€»ç»“

# åˆ é™¤é¢‘é“æ—¶é—´é…ç½®
/deletechannelschedule FireflyLeak
```

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
Sakura-Channel-Summary-Assistant/
â”‚
â”œâ”€â”€ ğŸ“„ æ ¸å¿ƒæºä»£ç æ–‡ä»¶
â”‚   â”œâ”€â”€ main.py                    # ä¸»ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ config.py                  # é…ç½®ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ ai_client.py               # AIå®¢æˆ·ç«¯æ¨¡å—
â”‚   â”œâ”€â”€ telegram_client.py         # Telegramå®¢æˆ·ç«¯æ¨¡å—
â”‚   â”œâ”€â”€ telegram_client_utils.py   # Telegramå®¢æˆ·ç«¯å·¥å…·æ¨¡å—ï¼ˆæ™ºèƒ½æ¶ˆæ¯åˆ†å‰²ï¼‰
â”‚   â”œâ”€â”€ command_handlers.py        # å‘½ä»¤å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ scheduler.py               # è°ƒåº¦å™¨æ¨¡å—
â”‚   â”œâ”€â”€ error_handler.py           # é”™è¯¯å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ prompt_manager.py          # æç¤ºè¯ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ summary_time_manager.py    # æ—¶é—´ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ web_app.py                 # Webç®¡ç†ç•Œé¢åº”ç”¨
â”‚   â”œâ”€â”€ restart_bot.py             # æœºå™¨äººé‡å¯è„šæœ¬
â”‚   â””â”€â”€ restart_bot_improved.py    # æ”¹è¿›ç‰ˆé‡å¯è„šæœ¬
â”‚
â”œâ”€â”€ ğŸ“ templates/                  # Webç•Œé¢æ¨¡æ¿
â”‚   â”œâ”€â”€ base.html                  # åŸºç¡€æ¨¡æ¿
â”‚   â”œâ”€â”€ dashboard.html             # ä»ªè¡¨æ¿
â”‚   â”œâ”€â”€ channels.html              # é¢‘é“ç®¡ç†
â”‚   â”œâ”€â”€ config.html                # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ tasks.html                 # ä»»åŠ¡ç®¡ç†
â”‚   â”œâ”€â”€ logs.html                  # æ—¥å¿—æŸ¥çœ‹
â”‚   â”œâ”€â”€ system.html                # ç³»ç»Ÿä¿¡æ¯
â”‚   â””â”€â”€ login.html                 # ç™»å½•é¡µé¢
â”‚
â”œâ”€â”€ ğŸ“ static/                     # é™æ€èµ„æº
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css              # æ ·å¼è¡¨
â”‚   â””â”€â”€ js/
â”‚       â””â”€â”€ script.js              # JavaScript
â”‚
â”œâ”€â”€ ğŸ“„ é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ .env                       # ç¯å¢ƒå˜é‡é…ç½®ï¼ˆä».env.exampleå¤åˆ¶ï¼‰
â”‚   â”œâ”€â”€ .env.example               # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”‚   â”œâ”€â”€ config.json                # AIé…ç½®æ–‡ä»¶ï¼ˆè¿è¡Œæ—¶ç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ prompt.txt                 # æç¤ºè¯æ–‡ä»¶ï¼ˆè¿è¡Œæ—¶ç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ .last_summary_time.json    # æ—¶é—´è®°å½•æ–‡ä»¶ï¼ˆè¿è¡Œæ—¶ç”Ÿæˆï¼‰
â”‚   â””â”€â”€ .gitignore                 # Gitå¿½ç•¥æ–‡ä»¶
â”‚
â”œâ”€â”€ ğŸ“„ ä¼šè¯æ–‡ä»¶ï¼ˆè¿è¡Œæ—¶ç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ bot_session.session        # Telegramä¸»ä¼šè¯
â”‚   â”œâ”€â”€ bot_session_web.session    # Webç•Œé¢ä¼šè¯
â”‚   â”œâ”€â”€ health_check.session       # å¥åº·æ£€æŸ¥ä¼šè¯
â”‚   â”œâ”€â”€ session_name.session       # ä¼šè¯åç§°æ–‡ä»¶
â”‚   â””â”€â”€ *.session-journal          # ä¼šè¯æ—¥å¿—æ–‡ä»¶
â”‚
â”œâ”€â”€ ğŸ“„ éƒ¨ç½²ä¸æ„å»ºæ–‡ä»¶
â”‚   â”œâ”€â”€ Dockerfile                 # Dockeré•œåƒæ„å»º
â”‚   â”œâ”€â”€ docker-compose.yml         # Docker Composeé…ç½®
â”‚   â”œâ”€â”€ docker-entrypoint.sh       # Dockerå…¥å£ç‚¹è„šæœ¬
â”‚   â”œâ”€â”€ requirements.txt           # Pythonä¾èµ–
â”‚   â”œâ”€â”€ start.bat                  # Windowså¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ sakura-bot.spec            # PyInstalleræ‰“åŒ…é…ç½®
â”‚
â”œâ”€â”€ ğŸ“„ æ–‡æ¡£æ–‡ä»¶
â”‚   â”œâ”€â”€ README.md                  # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”‚   â”œâ”€â”€ CHANGELOG.md               # æ›´æ–°æ—¥å¿—
â”‚   â”œâ”€â”€ LICENSE                    # è®¸å¯è¯æ–‡ä»¶
â”‚   â”œâ”€â”€ ERROR_HANDLING_IMPROVEMENTS.md # é”™è¯¯å¤„ç†æ”¹è¿›æ–‡æ¡£
â”‚   â””â”€â”€ MODULE_SPLIT_SUMMARY.md    # æ¨¡å—æ‹†åˆ†æ€»ç»“æ–‡æ¡£
â”‚
â””â”€â”€ ğŸ“ __pycache__/                # Pythonç¼“å­˜ç›®å½•ï¼ˆè¿è¡Œæ—¶ç”Ÿæˆï¼‰
```

**é‡è¦è¯´æ˜ï¼š**
- `data/` ç›®å½•åœ¨æ—§ç‰ˆæœ¬ä¸­ä½¿ç”¨ï¼Œæ–°ç‰ˆæœ¬å·²æ”¹ä¸ºä½¿ç”¨æ ¹ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶
- å¸¦ `*` çš„æ–‡ä»¶ä¸ºè¿è¡Œæ—¶è‡ªåŠ¨ç”Ÿæˆçš„æ–‡ä»¶
- é…ç½®æ–‡ä»¶ï¼ˆ`.env`ã€`config.json`ã€`prompt.txt`ï¼‰éœ€è¦æ ¹æ®å®é™…ç¯å¢ƒè¿›è¡Œé…ç½®

## ğŸ”§ æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç”¨é€” | ç‰ˆæœ¬ |
|------|------|------|
| **Python** | ä¸»ç¼–ç¨‹è¯­è¨€ | 3.13+ |
| **Telethon** | Telegram APIå®¢æˆ·ç«¯ | 1.34+ |
| **OpenAI SDK** | AI APIè°ƒç”¨ | 1.0+ |
| **APScheduler** | å®šæ—¶ä»»åŠ¡è°ƒåº¦ | 3.10+ |
| **Flask** | WebæœåŠ¡å™¨æ¡†æ¶ | 3.0+ |
| **Docker** | å®¹å™¨åŒ–éƒ¨ç½² | 20.10+ |
| **Docker Compose** | å®¹å™¨ç¼–æ’ | 2.0+ |

## ğŸ“ æ›´æ–°æ—¥å¿—

## [1.2.1] - 2026-01-11 ï¼ˆæœ€æ–°ï¼‰

### ä¿®å¤
- **EntityBoundsInvalidErroré”™è¯¯**ï¼šä¿®å¤äº†å‘é€é•¿æ¶ˆæ¯åˆ†æ®µæ—¶å‡ºç°çš„`EntityBoundsInvalidError: Some of provided entities have invalid bounds`é”™è¯¯
  - åˆ›å»ºæ™ºèƒ½æ¶ˆæ¯åˆ†å‰²ç®—æ³• (`telegram_client_utils.py`)ï¼Œä¿æŠ¤Markdownæ ¼å¼å®ä½“ä¸è¢«ç ´å
  - æ›´æ–°`send_long_message()`å‡½æ•°ä½¿ç”¨æ™ºèƒ½åˆ†å‰²ï¼Œç¡®ä¿**ç²—ä½“**ã€`å†…è”ä»£ç `ã€[é“¾æ¥]ç­‰å®ä½“å®Œæ•´æ€§
  - æ·»åŠ å®ä½“å®Œæ•´æ€§éªŒè¯å’Œè‡ªåŠ¨ä¿®å¤æœºåˆ¶ï¼Œå½“æ ¼å¼è¢«ç ´åæ—¶è‡ªåŠ¨ç§»é™¤æ ¼å¼é‡è¯•
  - ä¼˜å…ˆåœ¨æ®µè½ã€å¥å­ã€æ¢è¡Œç­‰è‡ªç„¶è¾¹ç•Œåˆ†å‰²ï¼Œé¿å…ç ´åæ¶ˆæ¯ç»“æ„
  - æä¾›ä¼˜é›…çš„å›é€€æœºåˆ¶ï¼šæ™ºèƒ½åˆ†å‰²å¤±è´¥æ—¶è‡ªåŠ¨ä½¿ç”¨ç®€å•å­—ç¬¦åˆ†å‰²

### æŠ€æœ¯å®ç°
- **æ™ºèƒ½åˆ†å‰²ç®—æ³•**ï¼šå®ç°`split_message_smart()`å‡½æ•°ï¼Œèƒ½å¤Ÿè¯†åˆ«å’Œä¿æŠ¤Markdownå®ä½“
- **å®ä½“ä¿æŠ¤**ï¼šç¡®ä¿**ç²—ä½“**ã€`ä»£ç `ã€[é“¾æ¥]ç­‰Markdownå®ä½“ä¸è¢«åˆ†å‰²ç ´å
- **è¾¹ç•Œæ£€æµ‹**ï¼šä¼˜å…ˆåœ¨è‡ªç„¶è¾¹ç•Œï¼ˆæ®µè½ã€å¥å­ï¼‰åˆ†å‰²ï¼Œå…¶æ¬¡åœ¨å•è¯è¾¹ç•Œåˆ†å‰²
- **éªŒè¯æœºåˆ¶**ï¼šæ¯ä¸ªåˆ†æ®µéƒ½éªŒè¯å®ä½“å®Œæ•´æ€§å’Œé•¿åº¦é™åˆ¶
- **é”™è¯¯æ¢å¤**ï¼šå‘é€å¤±è´¥æ—¶è‡ªåŠ¨å°è¯•ç§»é™¤æ ¼å¼é‡è¯•ï¼Œç¡®ä¿æ¶ˆæ¯èƒ½å¤Ÿé€è¾¾

### å½±å“èŒƒå›´
- ä¿®å¤å½±å“æ‰€æœ‰é•¿æ¶ˆæ¯å‘é€åŠŸèƒ½ï¼š
  - `/summary`å‘½ä»¤çš„é•¿æ¶ˆæ¯å‘é€
  - è‡ªåŠ¨å‘¨æŠ¥çš„é•¿æ¶ˆæ¯å‘é€
  - `/changelog`å‘½ä»¤çš„æ›´æ–°æ—¥å¿—å‘é€
  - æ‰€æœ‰ä½¿ç”¨`send_long_message()`æˆ–`send_report()`çš„åœ°æ–¹

## [1.2.0] - 2026-01-10

### æ–°å¢
- **æŠ•ç¥¨æ¶ˆæ¯åŠŸèƒ½**ï¼šå½“æ€»ç»“æ¶ˆæ¯å‘é€è‡³æºé¢‘é“æ—¶ï¼Œè‡ªåŠ¨ç”ŸæˆæŠ•ç¥¨æ¶ˆæ¯å¹¶å‘é€åˆ°è®¨è®ºç»„è¯„è®ºåŒº
  - AIæ ¹æ®æ€»ç»“å†…å®¹æ™ºèƒ½ç”Ÿæˆç›¸å…³æŠ•ç¥¨é—®é¢˜
  - è‡ªåŠ¨æ£€æµ‹é¢‘é“ç»‘å®šçš„è®¨è®ºç»„ï¼ˆlinked_chat_idï¼‰
  - æ”¯æŒTelegramæŠ•ç¥¨é•¿åº¦é™åˆ¶ï¼ˆé—®é¢˜255å­—ç¬¦ï¼Œé€‰é¡¹100å­—ç¬¦ï¼‰
  - è‡ªåŠ¨æ¸…ç†æŠ•ç¥¨æ–‡æœ¬ï¼Œç§»é™¤ä¸å¯è§å­—ç¬¦
  - æ”¯æŒè¢«åŠ¨ç›‘å¬è½¬å‘æ¶ˆæ¯æœºåˆ¶ï¼Œé¿å…æœºå™¨äººæƒé™é™åˆ¶
  - æä¾›é…ç½®å¼€å…³ï¼Œå¯é€šè¿‡`ENABLE_POLL`ç¯å¢ƒå˜é‡æ§åˆ¶åŠŸèƒ½å¼€å…³

### æŠ€æœ¯å®ç°
- **åº•å±‚RPCè°ƒç”¨**ï¼šç›´æ¥ä½¿ç”¨Telethonåº•å±‚`SendMediaRequest`ï¼Œç»•è¿‡é«˜çº§å‡½æ•°è½¬æ¢é—®é¢˜
- **æ­£ç¡®å¯¹è±¡åŒ…è£…**ï¼šä½¿ç”¨`TextWithEntities`åŒ…è£…æŠ•ç¥¨æ–‡æœ¬ï¼Œ`InputReplyToMessage`åŒ…è£…å›å¤ID
- **æ™ºèƒ½IDè½¬æ¢**ï¼šè‡ªåŠ¨å°†è®¨è®ºç»„IDè½¬æ¢ä¸ºTelethonè¶…çº§ç¾¤ç»„æ ¼å¼ï¼ˆ-100xxxxxxxxxï¼‰
- **å¤šçº§é”™è¯¯å¤„ç†**ï¼šæŠ•ç¥¨å¤±è´¥ä¸å½±å“ä¸»è¦æ€»ç»“æµç¨‹ï¼Œè®°å½•è¯¦ç»†é”™è¯¯æ—¥å¿—
- **å®¹é”™æœºåˆ¶**ï¼šè½¬å‘æ¶ˆæ¯è¶…æ—¶ï¼ˆ10ç§’ï¼‰åå‘é€ç‹¬ç«‹æŠ•ç¥¨æ¶ˆæ¯ä½œä¸ºå¤‡é€‰æ–¹æ¡ˆ

### é…ç½®
- åœ¨`config.py`ä¸­æ·»åŠ `ENABLE_POLL`é…ç½®é¡¹ï¼Œé»˜è®¤å€¼ä¸º`True`
- åœ¨`.env.example`ä¸­æ·»åŠ `ENABLE_POLL=True`é…ç½®ç¤ºä¾‹
- æ”¯æŒé€šè¿‡ç¯å¢ƒå˜é‡æˆ–é…ç½®æ–‡ä»¶æ§åˆ¶æŠ•ç¥¨åŠŸèƒ½å¼€å…³

### ä½¿ç”¨æ–¹å¼
1. **è‡ªåŠ¨è§¦å‘**ï¼šæ‰§è¡Œ`/summary`å‘½ä»¤æ—¶ï¼Œå¦‚æœé¢‘é“ç»‘å®šäº†è®¨è®ºç»„ä¸”å¯ç”¨äº†æŠ•ç¥¨åŠŸèƒ½ï¼Œä¼šè‡ªåŠ¨å‘é€æŠ•ç¥¨
2. **æ‰‹åŠ¨æ§åˆ¶**ï¼šé€šè¿‡è®¾ç½®`ENABLE_POLL=False`å¯ç¦ç”¨æŠ•ç¥¨åŠŸèƒ½
3. **æƒé™è¦æ±‚**ï¼šæœºå™¨äººéœ€è¦åŠ å…¥é¢‘é“çš„è®¨è®ºç»„ï¼ˆç§äººç¾¤ç»„ï¼‰æ‰èƒ½å‘é€æŠ•ç¥¨

> æŸ¥çœ‹å®Œæ•´æ›´æ–°æ—¥å¿—ï¼š`/changelog` æˆ– [CHANGELOG.md](CHANGELOG.md)

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ **Apache License 2.0** å¼€æºè®¸å¯è¯ã€‚

```
Copyright 2024 Sakura-é¢‘é“æ€»ç»“åŠ©æ‰‹

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ä»£ç ã€æŠ¥å‘Šé—®é¢˜æˆ–æå‡ºå»ºè®®ï¼

### è´¡çŒ®æµç¨‹

1. **Fork ä»“åº“**
2. **åˆ›å»ºåŠŸèƒ½åˆ†æ”¯** (`git checkout -b feature/amazing-feature`)
3. **æäº¤æ›´æ”¹** (`git commit -m 'Add some amazing feature'`)
4. **æ¨é€åˆ°åˆ†æ”¯** (`git push origin feature/amazing-feature`)
5. **å¼€å¯ Pull Request**

### è¡Œä¸ºå‡†åˆ™

è¯·é˜…è¯»æˆ‘ä»¬çš„ [è¡Œä¸ºå‡†åˆ™](CODE_OF_CONDUCT.md) ä»¥ç¡®ä¿ç¤¾åŒºå‹å¥½å’ŒåŒ…å®¹ã€‚

### æŠ¥å‘Šé—®é¢˜

å¦‚æœæ‚¨å‘ç°ä»»ä½•é—®é¢˜æˆ–æœ‰åŠŸèƒ½å»ºè®®ï¼Œè¯·é€šè¿‡ [GitHub Issues](https://github.com/Sakura520222/Sakura-Channel-Summary-Assistant/issues) æŠ¥å‘Šã€‚

---

<div align="center">
  
**ğŸŒ¸ Sakura-é¢‘é“æ€»ç»“åŠ©æ‰‹** Â· è®©é¢‘é“ç®¡ç†æ›´æ™ºèƒ½

[å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹) Â· [ä½¿ç”¨è¯´æ˜](#-ä½¿ç”¨è¯´æ˜) Â· [Dockeréƒ¨ç½²](#-dockeréƒ¨ç½²)

</div>
